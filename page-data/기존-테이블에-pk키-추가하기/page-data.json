{"componentChunkName":"component---src-templates-post-js","path":"/기존-테이블에-pk키-추가하기","result":{"data":{"markdownRemark":{"html":"<p>mssql에서 PK를 추가하려면 기존의 PK를 삭제해주고 재생성해줘야한다.\nmytable에 PK을 하나 더 추가하려고 PK 추가 구문을 아래와 같이 호출하면,\n아래와 같이 이미 기본키가 정의되었다는 에러메세지가 나오면서 실패한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> <span class=\"token punctuation\">[</span>dbo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>mytable<span class=\"token punctuation\">]</span> <span class=\"token keyword\">ADD</span>  <span class=\"token keyword\">CONSTRAINT</span> <span class=\"token punctuation\">[</span>PK_mytable<span class=\"token punctuation\">]</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token keyword\">CLUSTERED</span> \n<span class=\"token punctuation\">(</span>\n\t<span class=\"token punctuation\">[</span>otherPKColumn<span class=\"token punctuation\">]</span> <span class=\"token keyword\">ASC</span>\n<span class=\"token punctuation\">)</span><span class=\"token keyword\">WITH</span> <span class=\"token punctuation\">(</span>PAD_INDEX <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> STATISTICS_NORECOMPUTE <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> SORT_IN_TEMPDB <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> IGNORE_DUP_KEY <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> ONLINE <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> ALLOW_ROW_LOCKS <span class=\"token operator\">=</span> <span class=\"token keyword\">ON</span><span class=\"token punctuation\">,</span> ALLOW_PAGE_LOCKS <span class=\"token operator\">=</span> <span class=\"token keyword\">ON</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ON</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">PRIMARY</span><span class=\"token punctuation\">]</span>\nGO</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">메시지 <span class=\"token number\">1779</span><span class=\"token punctuation\">,</span> 수준 <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> 상태 <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> 줄 <span class=\"token number\">9</span>\n테이블 <span class=\"token string\">'mytable'</span>에 이미 기본 키가 정의되어 있습니다<span class=\"token punctuation\">.</span>\n메시지 <span class=\"token number\">1750</span><span class=\"token punctuation\">,</span> 수준 <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> 상태 <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> 줄 <span class=\"token number\">9</span>\n제약 조건을 만들 수 없습니다<span class=\"token punctuation\">.</span> 이전 오류를 참조하십시오<span class=\"token punctuation\">.</span></code></pre></div>\n<p>때문에 아래 호출을 통해 기본키를 정의한 PK 테이블 이름을 확인한다음, </p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">sp_helpconstraint <span class=\"token punctuation\">[</span>mytable<span class=\"token punctuation\">]</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">constraint_type constraint_name delete_action   update_action   status_enabled  status_for_replication  constraint_keys\n<span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">clustered</span><span class=\"token punctuation\">)</span>  PK_mytable  <span class=\"token punctuation\">(</span>n<span class=\"token operator\">/</span>a<span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">(</span>n<span class=\"token operator\">/</span>a<span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">(</span>n<span class=\"token operator\">/</span>a<span class=\"token punctuation\">)</span>  <span class=\"token punctuation\">(</span>n<span class=\"token operator\">/</span>a<span class=\"token punctuation\">)</span> Seq</code></pre></div>\n<p>Drop문으로 날려주고 재생성해야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> dbo<span class=\"token punctuation\">.</span>mytable <span class=\"token keyword\">DROP</span> <span class=\"token keyword\">CONSTRAINT</span> PK_mytable\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> <span class=\"token punctuation\">[</span>dbo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>mytable<span class=\"token punctuation\">]</span> <span class=\"token keyword\">ADD</span>  <span class=\"token keyword\">CONSTRAINT</span> <span class=\"token punctuation\">[</span>PK_mytable<span class=\"token punctuation\">]</span> <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token keyword\">CLUSTERED</span> \n<span class=\"token punctuation\">(</span>\n\t<span class=\"token punctuation\">[</span>Seq<span class=\"token punctuation\">]</span> <span class=\"token keyword\">ASC</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">[</span>otherPKColumn<span class=\"token punctuation\">]</span> <span class=\"token keyword\">ASC</span>\n<span class=\"token punctuation\">)</span><span class=\"token keyword\">WITH</span> <span class=\"token punctuation\">(</span>PAD_INDEX <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> STATISTICS_NORECOMPUTE <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> SORT_IN_TEMPDB <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> IGNORE_DUP_KEY <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> ONLINE <span class=\"token operator\">=</span> <span class=\"token keyword\">OFF</span><span class=\"token punctuation\">,</span> ALLOW_ROW_LOCKS <span class=\"token operator\">=</span> <span class=\"token keyword\">ON</span><span class=\"token punctuation\">,</span> ALLOW_PAGE_LOCKS <span class=\"token operator\">=</span> <span class=\"token keyword\">ON</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ON</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">PRIMARY</span><span class=\"token punctuation\">]</span>\nGO</code></pre></div>","timeToRead":1,"excerpt":"mssql에서 PK를 추가하려면 기존의 PK를 삭제해주고 재생성해줘야한다. \nmytable에 PK을 하나 더 추가하려고 PK…","frontmatter":{"title":"기존 테이블에 PK키 추가하기","cover":"","date":"2019-03-14T18:14:00.000Z","categories":["SQL"],"tags":["mssql","pk","insert"]},"fields":{"slug":"/기존-테이블에-pk키-추가하기","date":"March 13, 2019"}}},"pageContext":{"slug":"/기존-테이블에-pk키-추가하기","nexttitle":"ElasticSearch - 403 index read-only 에러가 발생했을 때","nextslug":"/elastic-search-403-index-read-only-에러가-발생했을-때","prevtitle":"insert into select 사용하기","prevslug":"/insert-into-select-사용하기"}}}